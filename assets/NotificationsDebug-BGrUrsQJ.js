import{k as j,j as s,S as N,B as u}from"./index-DqcaIE3D.js";import{R as h}from"./router-D53U3OCX.js";import"./supabase-BMIB7Fuo.js";import"./react-DQQtrPfG.js";import"./icons-DXR8YHNI.js";function y(){const{isSubscribed:x,subscribeToPush:m,unsubscribeFromPush:b,error:t}=j(),[i,f]=h.useState({permission:"unknown",swReady:!1,swScope:"",endpoint:"",hasVapid:!1});return h.useEffect(()=>{(async()=>{var o,r;try{const a=typeof Notification!="undefined"?Notification.permission:"unsupported";let c=!1,d="",l="";if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.ready;c=!!e,d=(e==null?void 0:e.scope)||"";const n=await e.pushManager.getSubscription();l=n!=null&&n.endpoint?String(n.endpoint):""}catch(e){console.debug("SW readiness/subscription check failed:",e)}const p=typeof window!="undefined"&&window.__QUIZ_DANGAL_ENV__?window.__QUIZ_DANGAL_ENV__:{},g=String(((r=(o=import.meta)==null?void 0:o.env)==null?void 0:r.VITE_VAPID_PUBLIC_KEY)||p.VITE_VAPID_PUBLIC_KEY||p.VAPID_PUBLIC_KEY||"").trim();f({permission:a,swReady:c,swScope:d,endpoint:l,hasVapid:g.length>0})}catch(a){console.debug("Notification diagnostics failed:",a)}})()},[]),s.jsxs("div",{className:"container mx-auto p-6 max-w-xl bg-white text-gray-900 rounded-2xl shadow-sm",children:[s.jsx(N,{title:"Notifications Debug – Quiz Dangal",description:"Push notification diagnostics and troubleshooting for Quiz Dangal.",canonical:"https://quizdangal.com/debug/notifications/",robots:"noindex, nofollow",author:"Quiz Dangal"}),s.jsx("h1",{className:"text-xl font-semibold mb-2",children:"Notifications Diagnostics"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Yahan aap push setup ka quick status dekh sakte hain."}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Permission:"})," ",i.permission]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Service Worker Ready:"})," ",i.swReady?"Yes":"No"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"SW Scope:"})," ",s.jsx("span",{className:"break-all",children:i.swScope||"—"})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Subscribed:"})," ",x?"Yes":"No"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Endpoint:"})," ",s.jsx("span",{className:"break-all",children:i.endpoint||"—"})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"VAPID Public Key present:"})," ",i.hasVapid?"Yes":"No"]}),t&&s.jsxs("div",{className:"text-red-600",children:["Error: ",t]})]}),s.jsxs("div",{className:"mt-4 flex gap-2",children:[s.jsx(u,{onClick:m,"aria-label":"Subscribe to push notifications",children:"Subscribe"}),s.jsx(u,{variant:"outline",onClick:b,"aria-label":"Unsubscribe from push notifications",children:"Unsubscribe"})]}),s.jsx("div",{className:"text-xs text-gray-500 mt-4",children:"Dev tip: Agar local pe SW register nahi ho raha, URL me ?sw=1 add karke page ek baar open karein."})]})}export{y as default};
