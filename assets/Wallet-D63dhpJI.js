import{u as E,a as W,h as N,j as e,S as M,s as u,l as y}from"./index-Bvf66Ja4.js";import{r as i,L as h}from"./router-D53U3OCX.js";import{m as n}from"./motion-lite-CITOPWQs.js";import{W as C,a as z,h as D,i as $,G as B,j as A,k as P,l as Q,e as G,T as I,m as V,n as U,o as H}from"./icons-r1jlw6dZ.js";import"./supabase-BMIB7Fuo.js";import"./react-DQQtrPfG.js";const Z=()=>{const{user:t,userProfile:c}=E(),[f,b]=i.useState([]),[S,g]=i.useState(!0),[R,p]=i.useState(!1),j=i.useMemo(()=>["credit","reward","bonus","referral","daily_login","quiz_reward","purchase","debit","refund","join_fee","prize"],[]),T=i.useMemo(()=>["reward","bonus","credit","referral","refund","daily_login","quiz_reward","prize"],[]),o=i.useCallback(async()=>{if(!t||!N||!u){b([]),g(!1);return}try{const{data:s,error:a}=await u.from("transactions").select("*").eq("user_id",t.id).in("type",j).not("type","is",null).not("amount","is",null).neq("amount",0).order("created_at",{ascending:!1}).limit(10);a&&y.error("Wallet transactions fetch error:",a),b(s||[])}catch(s){y.error("Wallet transactions exception:",s)}finally{g(!1)}},[t,j]);i.useEffect(()=>{o()},[o]);const _=(()=>{try{return!(typeof window=="undefined"||!("WebSocket"in window)||navigator&&navigator.onLine===!1)}catch(s){return!1}})();W({enabled:!!(t!=null&&t.id)&&_&&N&&!!u,channelName:t!=null&&t.id?`tx-updates-${t.id}`:void 0,event:"INSERT",table:"transactions",filter:t!=null&&t.id?`user_id=eq.${t.id}`:void 0,onChange:o,joinTimeoutMs:5e3});const r=Number((c==null?void 0:c.wallet_balance)||0),d=i.useRef(r);i.useEffect(()=>{const s=d.current;if(r>s){p(!0);const a=setTimeout(()=>p(!1),600);return d.current=r,()=>clearTimeout(a)}d.current=r},[r]);const v=s=>Number(s||0).toLocaleString(),k=s=>{const a=String(s||"").toLowerCase();return a.includes("ref")?{icon:G,bgClass:"bg-sky-500/20",textClass:"text-sky-400"}:a.includes("quiz")||a.includes("prize")||a.includes("reward")?{icon:I,bgClass:"bg-emerald-500/20",textClass:"text-emerald-400"}:a.includes("credit")||a.includes("daily")?{icon:z,bgClass:"bg-amber-500/20",textClass:"text-amber-400"}:a.includes("refund")?{icon:V,bgClass:"bg-indigo-500/20",textClass:"text-indigo-400"}:a.includes("purchase")?{icon:U,bgClass:"bg-fuchsia-500/20",textClass:"text-fuchsia-400"}:a.includes("debit")||a.includes("join")?{icon:H,bgClass:"bg-rose-500/20",textClass:"text-rose-400"}:{icon:C,bgClass:"bg-slate-500/20",textClass:"text-slate-400"}},L={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.06}}},l={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return e.jsxs("div",{className:"relative pt-14 pb-4",children:[e.jsx(M,{title:"Wallet â€“ Quiz Dangal",description:"View your Quiz Dangal wallet balance, recent transactions, and referral earnings.",canonical:"https://quizdangal.com/wallet/",robots:"noindex, nofollow",author:"Quiz Dangal",datePublished:"2025-01-01"}),e.jsxs(n.div,{className:"px-4 py-4 mx-auto w-full max-w-md sm:max-w-lg",variants:L,initial:"hidden",animate:"visible",children:[e.jsxs(n.div,{variants:l,className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center",children:e.jsx(C,{className:"w-5 h-5 text-white"})}),e.jsx("h1",{className:"text-xl font-bold text-white",children:"My Wallet"})]}),e.jsxs(n.div,{variants:l,className:"relative mb-5 rounded-2xl overflow-hidden border border-amber-500/20",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-900/40 via-slate-900 to-orange-900/30"}),e.jsxs("div",{className:"relative p-5 flex items-center gap-4",children:[e.jsx(n.div,{animate:R?{scale:[1,1.2,1]}:{},className:"w-14 h-14 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center shadow-lg shadow-amber-500/30",children:e.jsx(z,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-0.5",children:"Your Balance"}),e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsx("span",{className:"text-3xl font-black text-white",children:v(r)}),e.jsx("span",{className:"text-sm font-semibold text-amber-400",children:"coins"})]})]})]})]}),e.jsxs(n.div,{variants:l,className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsxs(h,{to:"/refer",className:"flex items-center justify-center gap-2 py-3 px-4 rounded-xl bg-gradient-to-r from-emerald-500 to-cyan-500 shadow-lg shadow-emerald-500/25 hover:shadow-emerald-500/40 hover:scale-[1.02] active:scale-[0.98] transition-all",children:[e.jsx(D,{className:"w-4 h-4 text-white"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Refer & Earn"})]}),e.jsxs(h,{to:"/redemptions",className:"flex items-center justify-center gap-2 py-3 px-4 rounded-xl bg-gradient-to-r from-violet-500 to-fuchsia-500 shadow-lg shadow-violet-500/25 hover:shadow-violet-500/40 hover:scale-[1.02] active:scale-[0.98] transition-all",children:[e.jsx($,{className:"w-4 h-4 text-white"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Redeem"})]})]}),e.jsx(n.div,{variants:l,className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-cyan-500/10 border border-cyan-500/30",children:[e.jsx(B,{className:"w-5 h-5 text-cyan-400"}),e.jsx(h,{to:"/",className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium text-cyan-200",children:"Play Quizzes to Earn More!"})})]})}),e.jsxs(n.div,{variants:l,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Recent Activity"]})}),S?e.jsx("div",{className:"space-y-2",children:[1,2,3].map(s=>e.jsx("div",{className:"p-3 rounded-xl bg-slate-800/40 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-slate-700"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 w-20 bg-slate-700 rounded mb-2"}),e.jsx("div",{className:"h-2 w-14 bg-slate-700 rounded"})]}),e.jsx("div",{className:"h-4 w-16 bg-slate-700 rounded"})]})},s))}):f.length===0?e.jsxs("div",{className:"text-center py-10 bg-slate-800/30 rounded-2xl border border-dashed border-slate-700/50",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸª™"}),e.jsx("p",{className:"text-slate-400 font-medium mb-1",children:"No transactions yet"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Play quizzes and start earning!"})]}):e.jsx("div",{className:"space-y-2",children:f.map((s,a)=>{const w=(s.type||"").toLowerCase(),m=T.includes(w),x=k(w),q=x.icon;return e.jsxs(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.04},className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-xl border border-slate-700/30 hover:border-slate-600/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 rounded-full ${x.bgClass} flex items-center justify-center`,children:e.jsx(q,{className:`w-4 h-4 ${x.textClass}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-200 capitalize",children:s.type||"Transaction"}),e.jsx("p",{className:"text-xs text-slate-500",children:new Date(s.created_at).toLocaleDateString("en-IN",{day:"numeric",month:"short"})})]})]}),e.jsxs("div",{className:`flex items-center gap-1 ${m?"text-emerald-400":"text-rose-400"}`,children:[m?e.jsx(P,{className:"w-4 h-4"}):e.jsx(Q,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-bold text-sm",children:[m?"+":"-",v(Math.abs(Number(s.amount)||0))]})]})]},s.id)})})]})]})]})};export{Z as default};
