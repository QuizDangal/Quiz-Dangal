import{l as ot,R as qt,v as $t,e as Jt,u as Ut,k as Ot,g as Y,o as yt,j as e,S as Qt,t as bt,f as Q,p as jt,c as vt}from"./index-Beuxb_yr.js";import{g as Rt,u as Wt,f as Ft,r as z}from"./router-CWIfZQRv.js";import{m as Vt}from"./motion-lite-CguNR5TK.js";import{s as Bt}from"./smartJoinQuiz-r-TZUQrI.js";import{j as Nt,p as wt,M as It,B as Gt,T as Ht,d as Kt}from"./icons-BNA5wz6Z.js";import"./supabase-cQshKuiM.js";import"./react-MKCYUrdX.js";function Xt(s){var f,p,v,u,y,w,N,I,d,h;if(!s)return null;const r=Number((v=(p=(f=s.participants_joined)!=null?f:s.joined_count)!=null?p:s.joined)!=null?v:0),m=Number((w=(y=(u=s.participants_pre)!=null?u:s.pre_joined_count)!=null?y:s.pre_joined)!=null?w:0),l=Number((N=s.participants_total)!=null?N:r+m),g=s.id||s.slot_id||s.quiz_slot_id||null,E=s.quiz_id||s.quizid||null;return{slotId:g,quizId:E,category:s.category||null,title:s.quiz_title||s.title||s.slot_title||null,start_time:s.start_time||s.slot_start||s.starts_at||null,end_time:s.end_time||s.slot_end||s.ends_at||null,status:s.status||"scheduled",prizes:Array.isArray(s.prizes)?s.prizes:Array.isArray(s.quiz_prizes)?s.quiz_prizes:[],questions:Array.isArray(s.questions)?s.questions:[],prize_type:s.prize_type||s.quiz_prize_type||"coins",participants_joined:r,participants_pre:m,participants_total:l,questions_count:Number((h=(d=(I=s.questions_count)!=null?I:s.question_count)!=null?d:s.q_count)!=null?h:0),auto_enabled:typeof s.auto_enabled=="boolean"?s.auto_enabled:void 0,stop_override:!!s.stop_override}}async function Yt(s,r){if(!s)return{slots:[],mode:"none",auto:!0};let m=[],l=[],g=!0;try{const{data:u,error:y}=await s.from("quiz_slots_view").select("*").eq("category",r).order("start_time",{ascending:!0});!y&&u&&(m=u.map(Xt))}catch(u){ot.debug("quiz_slots_view error",u.message||u)}try{const{data:u,error:y}=await s.from("quizzes").select("id,title,start_time,end_time,status,prizes,prize_type,slot_id,questions(count)").eq("category",r).order("start_time",{ascending:!0});if(!y&&u){const w=Date.now(),N=(u||[]).filter(d=>!d.slot_id);let I={};if(N.length>0)try{const{data:d}=await s.rpc("get_engagement_counts_many",{p_quiz_ids:N.map(h=>h.id)});if(d)for(const h of d)I[h.quiz_id]=(h.pre_joined||0)+(h.joined||0)}catch(d){ot.debug("get_engagement_counts_many RPC error (non-critical):",(d==null?void 0:d.message)||d)}l=N.map(d=>{var h,R;return{slotId:d.id,quizId:d.id,category:r,title:d.title,quiz_title:d.title,start_time:d.start_time,end_time:d.end_time,status:Zt(d,w),prizes:Array.isArray(d.prizes)?d.prizes:[],prize_type:d.prize_type||"coins",participants_joined:I[d.id]||0,participants_total:I[d.id]||0,questions_count:((R=(h=d.questions)==null?void 0:h[0])==null?void 0:R.count)||0,auto_enabled:!0,isLegacy:!0}})}}catch(u){ot.debug("Legacy quizzes fetch error",u.message||u)}try{const{data:u,error:y}=await s.from("category_runtime_overrides").select("category,auto_enabled:is_auto").eq("category",r).maybeSingle();!y&&u&&(g=!!u.auto_enabled)}catch(u){}const E=new Set(m.map(u=>u.quizId).filter(Boolean)),f=l.filter(u=>!E.has(u.quizId)),p=[...m,...f];p.sort((u,y)=>{const w=u.start_time?new Date(u.start_time).getTime():0,N=y.start_time?new Date(y.start_time).getTime():0;return w-N});const v=m.length>0?"slots":f.length>0?"legacy":"none";return{slots:p,mode:v,auto:g}}function Zt(s,r){const m=s.start_time?new Date(s.start_time).getTime():null,l=s.end_time?new Date(s.end_time).getTime():null;return m&&l&&r>=m&&r<l?"active":m&&r<m?"scheduled":l&&r>=l?"finished":"scheduled"}function te(s){const r=Date.now(),m=s.find(f=>{const p=f!=null&&f.start_time?new Date(f.start_time).getTime():null,v=f!=null&&f.end_time?new Date(f.end_time).getTime():null;return p&&v&&r>=p&&r<v}),l=s.filter(f=>{const p=f!=null&&f.start_time?new Date(f.start_time).getTime():null;return p?r<p:!1});l.sort((f,p)=>new Date(f.start_time).getTime()-new Date(p.start_time).getTime());const g=l[0]||null,E=l[1]||null;return{live:m,next:g,queued:E}}const k=new Map,ee=500;let Tt=0;function Z(s){if(k.size>=ee||Tt%200===0||k.size>=100)for(const[r,m]of k.entries()){const l=(m.windowMs||qt)*2;s-m.firstTs>l&&k.delete(r)}}function se(s,{max:r=$t,windowMs:m=qt}={}){Tt+=1;const l=Date.now(),g=k.get(s);return g?l-g.firstTs>g.windowMs?(k.set(s,{count:1,firstTs:l,windowMs:m}),Z(l),{allowed:!0,remaining:r-1}):g.count>=r?(Z(l),{allowed:!1,remaining:0}):(g.count+=1,Z(l),{allowed:!0,remaining:r-g.count}):(k.set(s,{count:1,firstTs:l,windowMs:m}),Z(l),{allowed:!0,remaining:r-1})}function ie(s=""){const r=String(s||"").toLowerCase();return r.includes("opinion")?{title:"Opinion Quizzes",emoji:"ðŸ’¬",Icon:It,from:"from-indigo-600/30",to:"to-fuchsia-600/30",ring:"ring-fuchsia-500/30"}:r.includes("gk")?{title:"GK Quizzes",emoji:"ðŸ§ ",Icon:Gt,from:"from-emerald-600/30",to:"to-teal-600/30",ring:"ring-emerald-500/30"}:r.includes("sport")?{title:"Sports Quizzes",emoji:"ðŸ†",Icon:Ht,from:"from-orange-600/30",to:"to-red-600/30",ring:"ring-orange-500/30"}:r.includes("movie")?{title:"Movie Quizzes",emoji:"ðŸŽ¬",Icon:Kt,from:"from-violet-600/30",to:"to-indigo-600/30",ring:"ring-violet-500/30"}:{title:`${s} Quizzes`,emoji:"â­",Icon:It,from:"from-sky-600/30",to:"to-indigo-600/30",ring:"ring-sky-500/30"}}const T=s=>s!=null&&s.start_time?new Date(s.start_time).getTime():null,lt=s=>s!=null&&s.end_time?new Date(s.end_time).getTime():null,St=s=>{const r=T(s),m=lt(s);if(!r||!m)return!1;const l=Date.now();return l>=r&&l<m},ne=s=>{const r=T(s);return r?Date.now()<r:!1},ae=300*1e3,ge=()=>{const{slug:s}=Rt(),r=Wt(),m=Ft(),{toast:l}=Jt(),{user:g}=Ut(),{isSubscribed:E,subscribeToPush:f}=Ot(),[p]=z.useState([]),[v,u]=z.useState(!0),[y,w]=z.useState(null),[N,I]=z.useState({}),[d,h]=z.useState({}),[R,ct]=z.useState(0),[S,dt]=z.useState([]),[L,W]=z.useState("legacy"),[Dt,ut]=z.useState(!0),[re,tt]=z.useState(null),Et=2e4,F=z.useCallback(async()=>{try{const t=await Y();if(!t){dt([]),ut(!0),W("legacy"),tt("Supabase is not configured.");return}const{slots:n,mode:a,auto:i}=await Yt(t,s);dt(n),ut(i),tt(null),W(a==="slots"||a==="legacy"?"slots":"legacy")}catch(t){tt(yt(t)||(t==null?void 0:t.message)||"Could not load category quizzes."),W("legacy")}},[s]);z.useEffect(()=>{u(!0),F().finally(()=>{u(!1)})},[F]),z.useEffect(()=>{if(L==="none")return;const t=setInterval(()=>{F()},Et);return()=>clearInterval(t)},[L,F]),z.useEffect(()=>{const t=Date.now();if(!(p||[]).some(i=>{const o=i.start_time?new Date(i.start_time).getTime():0,c=i.end_time?new Date(i.end_time).getTime():0;return o&&t<o||o&&c&&t>=o&&t<c}))return;const a=setInterval(()=>ct(i=>(i+1)%1e6),1e3);return()=>clearInterval(a)},[p]),z.useEffect(()=>{if(L!=="slots")return;const t=Date.now();if(!(S||[]).some(i=>{const o=i.start_time?new Date(i.start_time).getTime():0,c=i.end_time?new Date(i.end_time).getTime():0;return o&&t<o||o&&c&&t>=o&&t<c}))return;const a=setInterval(()=>ct(i=>(i+1)%1e6),1e3);return()=>clearInterval(a)},[S,L]),z.useEffect(()=>{const t=async()=>{try{const n=await Y();if(!n)return;const a=(p||[]).map(x=>x.id);if(!a.length){I({});return}const{data:i,error:o}=await n.rpc("get_engagement_counts_many",{p_quiz_ids:a});if(o)throw o;const c={};for(const x of i||[]){const b=x.pre_joined||0,j=x.joined||0;c[x.quiz_id]=b+j}I(c)}catch(n){}};p&&p.length&&t()},[p]),z.useEffect(()=>{(async()=>{const n=c=>!c||typeof c!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c),a=(p||[]).map(c=>c.id).filter(n),i=(S||[]).map(c=>c.quizId||c.quiz_id||c.id).filter(n),o=[...new Set([...a,...i])];if(!g||!o.length){h({});return}try{const c=await Y();if(!c){h({});return}const x={},{data:b,error:j}=await c.from("quiz_participants").select("quiz_id,status").eq("user_id",g.id).in("quiz_id",o);if(!j&&b)for(const _ of b)_.quiz_id&&(x[_.quiz_id]=_.status==="pre_joined"?"pre":"joined");for(const _ of S||[]){const A=_.quizId||_.quiz_id||_.id;A&&x[A]&&_.slotId&&(x[_.slotId]=x[A])}h(x)}catch(c){h({})}})()},[g,p,S]);const mt=async t=>{if(!g){l({title:"Login required",description:"Please sign in to join the quiz.",variant:"destructive"}),r("/login");return}const n=await Y();if(!n){l({title:"Setup required",description:"Supabase is not configured for this app.",variant:"destructive"});return}const a=t.slotId||t.id;try{const i=String((t==null?void 0:t.status)||"").trim().toLowerCase();if(i==="paused"||i==="stopped"||i==="skipped"||t!=null&&t.stop_override){l({title:"Paused",description:"This category is paused right now. Please try later.",variant:"destructive"});return}}catch(i){}w(a);try{typeof Notification!="undefined"&&Notification.permission!=="granted"&&!E&&Promise.resolve().then(()=>f()).catch(()=>{})}catch(i){}try{const i=await Bt({supabase:n,quiz:t,user:g});if(i.status==="error")throw i.error;i.status==="already"?(h(o=>({...o,[a]:"joined"})),l({title:"Already Joined",description:"You are in this quiz."})):i.status==="joined"?(h(c=>({...c,[a]:"joined"})),se(`join_${(g==null?void 0:g.id)||"anon"}`,{max:4,windowMs:8e3}).allowed?(l({title:"Joined!",description:"Taking you to the quiz."}),r(t.slotId&&!t.isLegacy?`/quiz/slot/${t.slotId}`:`/quiz/${t.id}`)):l({title:"Slow down",description:"Please wait a moment before trying again.",variant:"destructive"})):i.status==="pre_joined"?(h(o=>({...o,[a]:"pre"})),l({title:"Pre-joined!",description:"We will remind you before start."})):i.status==="scheduled_retry"&&(h(o=>({...o,[a]:"pre"})),l({title:"Pre-joined!",description:"Auto joining at start time."}))}catch(i){const o=yt(i);l({title:"Error",description:o||(i==null?void 0:i.message)||"Could not join quiz.",variant:"destructive"})}finally{w(null)}},pt=p.filter(t=>{if(L==="slots")return!1;const n=Date.now(),a=t.start_time?new Date(t.start_time).getTime():0,i=t.end_time?new Date(t.end_time).getTime():0,o=a&&i&&n>=a&&n<i,c=a&&n<a;return o||c}),P=ie(s),M=Date.now(),V=L==="slots",B=V?S:p||[],Lt=(S||[]).filter(t=>{const n=T(t),a=lt(t),i=M;return n&&a&&i>=n&&i<a||String((t==null?void 0:t.status)||"").toLowerCase()==="active"}),$=(S||[]).filter(n=>{const a=T(n);return a?a>M:!1}).sort((n,a)=>(T(n)||0)-(T(a)||0))[0]||null,gt=(()=>{const t=$?T($):null;if(!t)return!1;const n=t-M;return n>0&&n<=ae})(),G=[...Lt];$&&gt&&(G.some(n=>(n==null?void 0:n.slotId)&&n.slotId===$.slotId)||G.push($));const Mt=V?B.filter(t=>St(t)).length:B.reduce((t,n)=>{const a=n.start_time?new Date(n.start_time).getTime():0,i=n.end_time?new Date(n.end_time).getTime():0;return t+(a&&i&&M>=a&&M<i?1:0)},0),At=V&&$&&gt?1:0,et=V?B.map(t=>T(t)).filter(t=>t&&t>M).sort((t,n)=>t-n)[0]||null:B.map(t=>t.start_time?new Date(t.start_time).getTime():null).filter(t=>t&&t>M).sort((t,n)=>t-n)[0]||null,{next:H}=te(S),Ct=t=>{var ht,zt,_t;if(!t)return null;const n=Date.now(),a=T(t),i=lt(t),o=St(t),c=t.status==="paused",x=t.status==="finished"||i&&n>=i,b=ne(t),j=b&&a?Math.max(0,Math.floor((a-n)/1e3)):o&&i?Math.max(0,Math.floor((i-n)/1e3)):null,_=Array.isArray(t.prizes)?t.prizes:[],A=t.prize_type||"coins",st=(ht=_[0])!=null?ht:0,it=(zt=_[1])!=null?zt:0,nt=(_t=_[2])!=null?_t:0,C=Pt=>vt(A,Pt,{fallback:0}).formatted,at=t.participants_total||t.participants_joined||0,K=t.questions_count||10,X=!Dt&&!o&&!b,D=o&&!x?"LIVE":c?"PAUSED":X?"STOPPED":b?"UPCOMING":x?"FINISHED":(t.status||"").toUpperCase(),O=t.isLegacy?t.quizId:t.slotId,q=!!d[O],J=y===O,xt=x?"Results":o?q?"Play":"Join Now":b?q?"Joined âœ“":"Pre-Join":"View",kt=async()=>{if(x){r(t.isLegacy?`/quiz/${t.quizId}`:`/quiz/slot/${t.slotId}`);return}if(!g){l({title:"Login Required",description:"Please login to join the quiz.",variant:"destructive"}),r("/login",{state:{from:m.pathname,message:"Login to join the quiz"}});return}if(q&&!o){r(t.isLegacy?`/quiz/${t.quizId}`:`/quiz/slot/${t.slotId}`);return}if(o){r(t.isLegacy?`/quiz/${t.quizId}`:`/quiz/slot/${t.slotId}`);return}b&&!q&&await mt({id:t.quizId,...t})};return e.jsx("div",{className:"quiz-slot-card",children:e.jsxs("div",{className:`quiz-slot-card-inner ${o?"quiz-slot-card-live":""}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"quiz-slot-lang",children:"ðŸŒ Hindi / English"}),e.jsxs("span",{className:`quiz-slot-badge ${D==="LIVE"?"quiz-slot-badge-live":D==="UPCOMING"?"quiz-slot-badge-upcoming":D==="PAUSED"?"quiz-slot-badge-paused":"quiz-slot-badge-default"}`,children:[D==="LIVE"&&e.jsx("span",{className:"quiz-slot-badge-dot"}),D]})]}),e.jsx("h3",{className:"text-sm sm:text-base font-bold text-white mb-3 line-clamp-2",children:t.quiz_title||t.title||"Quiz"}),e.jsxs("div",{className:"quiz-slot-time-section",children:[e.jsxs("div",{className:"quiz-slot-time-row",children:[e.jsxs("div",{className:"quiz-slot-time-box",children:[e.jsx("span",{className:"quiz-slot-time-label",children:"START"}),e.jsx("span",{className:"quiz-slot-time-value",children:t.start_time?Q(t.start_time):"â€”"})]}),e.jsx("div",{className:"quiz-slot-time-divider",children:"â†’"}),e.jsxs("div",{className:"quiz-slot-time-box",children:[e.jsx("span",{className:"quiz-slot-time-label",children:"END"}),e.jsx("span",{className:"quiz-slot-time-value",children:t.end_time?Q(t.end_time):"â€”"})]})]}),j!==null&&e.jsxs("div",{className:`quiz-slot-timer ${o?"quiz-slot-timer-live":""}`,children:[e.jsx(Nt,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:b?"Starts in":"Ends in"}),e.jsxs("span",{className:"quiz-slot-timer-value",children:[Math.floor(j/60).toString().padStart(2,"0"),":",(j%60).toString().padStart(2,"0")]})]})]}),e.jsxs("div",{className:"quiz-slot-prize-section",children:[e.jsx("div",{className:"quiz-slot-prize-title",children:"ðŸ† Prizes"}),e.jsxs("div",{className:"quiz-slot-prize-row",children:[e.jsxs("div",{className:"quiz-slot-prize-item quiz-slot-prize-gold",children:[e.jsx("span",{className:"quiz-slot-prize-rank",children:"1st"}),e.jsx("span",{className:"quiz-slot-prize-value",children:C(st)})]}),e.jsxs("div",{className:"quiz-slot-prize-item quiz-slot-prize-silver",children:[e.jsx("span",{className:"quiz-slot-prize-rank",children:"2nd"}),e.jsx("span",{className:"quiz-slot-prize-value",children:C(it)})]}),e.jsxs("div",{className:"quiz-slot-prize-item quiz-slot-prize-bronze",children:[e.jsx("span",{className:"quiz-slot-prize-rank",children:"3rd"}),e.jsx("span",{className:"quiz-slot-prize-value",children:C(nt)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("span",{className:"quiz-slot-stat",children:["ðŸ“ ",K," Questions"]}),e.jsxs("span",{className:"quiz-slot-stat",children:[e.jsx(wt,{className:"w-3 h-3"})," ",at," Joined"]})]}),e.jsx("button",{type:"button",disabled:J||q&&b,onClick:kt,onMouseEnter:()=>jt(t.isLegacy?`/quiz/${t.quizId}`:`/quiz/slot/${t.slotId}`),className:`quiz-slot-btn ${J?"opacity-50 cursor-wait":q&&b?"quiz-slot-btn-joined":o?"quiz-slot-btn-live":"quiz-slot-btn-default"}`,children:J?"Joining...":xt})]})},t.slotId)};z.useEffect(()=>{if(!H)return;const t=H.start_time?new Date(H.start_time).getTime():null;if(!t)return;const n=Date.now(),a=t-n-6e4;if(a<=0||a>1800*1e3)return;const i=setTimeout(()=>{try{l({title:"Upcoming Slot",description:"1 minute to start â€“ be ready!",duration:4e3})}catch(o){}},a);return()=>clearTimeout(i)},[H,l]);const ft=typeof window!="undefined"?`${window.location.origin}/category/${s}/`:`https://quizdangal.com/category/${s}/`;return e.jsxs("div",{className:"px-3 sm:px-4 pt-14 sm:pt-16 pb-6",children:[e.jsx(Qt,{title:`${P.title} â€“ Quiz Dangal`,description:`Active and upcoming quizzes in ${P.title}. Play daily ${P.title.toLowerCase()} on Quiz Dangal and earn coins.`,canonical:ft,robots:"index, follow",alternateLocales:["hi_IN","en_US"],author:"Quiz Dangal",datePublished:"2025-01-01",dateModified:"2025-12-29",jsonLd:[{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"Home",item:"https://quizdangal.com/"},{"@type":"ListItem",position:2,name:P.title,item:ft}]}]}),e.jsx("span",{className:"hidden","aria-hidden":!0,children:R}),e.jsxs("div",{className:"max-w-md sm:max-w-2xl lg:max-w-4xl mx-auto space-y-4",children:[e.jsx("div",{className:"p-[1px] rounded-xl sm:rounded-2xl bg-gradient-to-r from-indigo-500/50 via-violet-500/40 to-fuchsia-500/50",children:e.jsxs("div",{className:"rounded-xl sm:rounded-2xl bg-slate-900/95 p-3 sm:p-4 lg:p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 mb-2",children:[e.jsx("div",{className:"w-9 h-9 sm:w-12 sm:h-12 lg:w-14 lg:h-14 rounded-lg sm:rounded-xl bg-gradient-to-br from-indigo-500 to-violet-600 flex items-center justify-center text-lg sm:text-2xl lg:text-3xl",children:P.emoji}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-base sm:text-xl lg:text-2xl font-bold text-white truncate",children:P.title}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 text-[10px] sm:text-xs mt-1",children:[e.jsxs("span",{className:"px-1.5 sm:px-2.5 py-0.5 sm:py-1 rounded sm:rounded-md bg-emerald-600/20 text-emerald-300 border border-emerald-600/30",children:[Mt," live"]}),e.jsxs("span",{className:"px-1.5 sm:px-2.5 py-0.5 sm:py-1 rounded sm:rounded-md bg-sky-600/20 text-sky-300 border border-sky-600/30",children:[At," upcoming"]})]})]})]}),et&&e.jsxs("div",{className:"flex items-center gap-1 text-[10px] sm:text-xs text-slate-400",children:[e.jsx(Nt,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Next: ",bt(et)," â€¢ ",Q(et)]})]})}),!1,L==="slots"?e.jsx(e.Fragment,{children:v?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:Array.from({length:3}).map((t,n)=>e.jsx("div",{className:"h-40 sm:h-48 lg:h-52 rounded-xl sm:rounded-2xl bg-slate-800/60 border border-slate-700/60 animate-pulse"},n))}):e.jsx(e.Fragment,{children:G.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:G.map(t=>Ct(t))}):e.jsx("div",{className:"rounded-xl sm:rounded-2xl border border-slate-800 bg-slate-900/50 p-4 sm:p-6 text-center text-sm sm:text-base text-slate-400",children:"No quizzes scheduled yet."})})}):v?e.jsx("div",{className:"grid gap-3 sm:gap-4",children:Array.from({length:4}).map((t,n)=>e.jsx("div",{className:"h-24 sm:h-28 rounded-xl sm:rounded-2xl bg-slate-800/60 border border-slate-700/60 animate-pulse"},n))}):pt.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-16",children:"No quizzes in this category yet."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:pt.map((t,n)=>{var rt,q,J;const a=Date.now(),i=t.start_time?new Date(t.start_time).getTime():null,o=t.end_time?new Date(t.end_time).getTime():null,c=i&&o&&a>=i&&a<o,x=i&&a<i,b=c||x,j=x&&i?Math.max(0,Math.floor((i-a)/1e3)):c&&o?Math.max(0,Math.floor((o-a)/1e3)):null,_=Array.isArray(t.prizes)?t.prizes:[],A=t.prize_type||"coins",st=(rt=_[0])!=null?rt:0,it=(q=_[1])!=null?q:0,nt=(J=_[2])!=null?J:0,C=U=>vt(A,U,{fallback:0}).formatted,at=N[t.id]||0,K=d[t.id],X=!!K,D=i&&o?Math.max(1,o-i):null,O=c&&D?Math.min(100,Math.max(0,Math.round((a-i)/D*100))):null;return e.jsx(Vt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:n*.02},onClick:()=>r(`/quiz/${t.id}`),className:"cursor-pointer",role:"button",tabIndex:0,onKeyDown:U=>{U.key==="Enter"&&r(`/quiz/${t.id}`)},children:e.jsx("div",{className:`p-[1px] rounded-xl sm:rounded-2xl ${c?"bg-gradient-to-r from-emerald-500/60 to-green-500/60":"bg-gradient-to-r from-indigo-500/40 via-violet-500/30 to-fuchsia-500/40"}`,children:e.jsxs("div",{className:"rounded-xl sm:rounded-2xl bg-slate-900/95 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("h3",{className:"text-sm sm:text-base font-bold text-white flex-1 min-w-0 line-clamp-2",children:t.title}),e.jsxs("div",{className:"shrink-0 flex items-center gap-1",children:[c&&e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[9px] sm:text-[10px] font-bold bg-rose-600 text-white",children:"LIVE"}),x&&e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[9px] sm:text-[10px] font-bold bg-sky-600 text-white",children:"SOON"}),K&&e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[9px] sm:text-[10px] font-semibold bg-indigo-600/20 text-indigo-300 border border-indigo-500/40",children:"Joined"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 text-[10px] sm:text-xs mb-2",children:[e.jsxs("span",{className:"px-1.5 sm:px-2 py-1 rounded bg-amber-500/15 text-amber-300 border border-amber-600/30",children:["ðŸ¥‡ ",C(st)]}),e.jsxs("span",{className:"px-1.5 sm:px-2 py-1 rounded bg-sky-500/15 text-sky-300 border border-sky-600/30",children:["ðŸ¥ˆ ",C(it)]}),e.jsxs("span",{className:"px-1.5 sm:px-2 py-1 rounded bg-violet-500/15 text-violet-300 border border-violet-600/30",children:["ðŸ¥‰ ",C(nt)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] sm:text-xs text-slate-400 mb-2",children:[e.jsx("span",{children:t.start_time?bt(t.start_time):"â€”"}),e.jsxs("span",{className:"px-1.5 sm:px-2 py-0.5 sm:py-1 rounded bg-slate-800/60 border border-slate-700/50",children:[t.start_time?Q(t.start_time):"â€”"," - ",t.end_time?Q(t.end_time):"â€”"]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-[10px] sm:text-xs text-slate-500",children:[e.jsx(wt,{className:"w-3 h-3 sm:w-4 sm:h-4"}),at," joined"]}),j!==null&&e.jsxs("div",{className:"text-xs sm:text-sm font-semibold text-indigo-300",children:[x?"In":"Ends"," ",Math.floor(j/60).toString().padStart(2,"0"),":",(j%60).toString().padStart(2,"0")]})]}),O!==null&&e.jsx("div",{className:"mb-2 w-full bg-slate-800 rounded-full h-1 sm:h-1.5 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${O}%`}})}),e.jsx("button",{type:"button",onClick:U=>{U.stopPropagation(),X||!b?r(`/quiz/${t.id}`):mt(t)},onMouseEnter:()=>jt("/quiz"),disabled:y===t.id,className:`w-full h-9 sm:h-10 rounded-lg text-xs sm:text-sm font-bold text-white transition ${c?"bg-gradient-to-r from-emerald-600 to-green-500 hover:opacity-90":"bg-gradient-to-r from-indigo-600 to-violet-600 hover:opacity-90"} ${y===t.id?"opacity-80":""}`,children:X?"JOINED":b?y===t.id?"JOININGâ€¦":"JOIN":"VIEW"})]})})},t.id)})})]})]})};export{ge as default};
