import{u as k,h as N,d as u,a as q,j as e,S as M}from"./index-4159bffa.js";import{r as i}from"./react-63c462fe.js";import{L as h}from"./router-5fd03704.js";import{m as r}from"./motion-lite-a13d6934.js";import{W as y,C as z,h as W,i as $,G as B,f as D,j as A,k as G,e as I,T as P,l as Q,m as V,L as O}from"./icons-d9b262e9.js";import"./supabase-24c2e735.js";const X=()=>{const{user:t,userProfile:c}=k(),[f,p]=i.useState([]),[S,b]=i.useState(!0),[C,j]=i.useState(!1),g=i.useMemo(()=>["credit","reward","bonus","referral","daily_login","quiz_reward","purchase","debit","refund","join_fee","prize"],[]),R=i.useMemo(()=>["reward","bonus","credit","referral","refund","daily_login","quiz_reward","prize"],[]),o=i.useCallback(async()=>{if(!t||!N||!u){p([]),b(!1);return}try{const{data:s,error:a}=await u.from("transactions").select("*").eq("user_id",t.id).in("type",g).not("type","is",null).not("amount","is",null).neq("amount",0).order("created_at",{ascending:!1}).limit(10);a&&console.error(a),p(s||[])}catch(s){console.error(s)}finally{b(!1)}},[t,g]);i.useEffect(()=>{o()},[o]);const T=(()=>{try{return!(typeof window=="undefined"||!("WebSocket"in window)||navigator&&navigator.onLine===!1)}catch(s){return!1}})();q({enabled:!!(t!=null&&t.id)&&T&&N&&!!u,channelName:t!=null&&t.id?`tx-updates-${t.id}`:void 0,event:"INSERT",table:"transactions",filter:t!=null&&t.id?`user_id=eq.${t.id}`:void 0,onChange:o,joinTimeoutMs:5e3});const n=Number((c==null?void 0:c.wallet_balance)||0),d=i.useRef(n);i.useEffect(()=>{const s=d.current;if(n>s){j(!0);const a=setTimeout(()=>j(!1),600);return d.current=n,()=>clearTimeout(a)}d.current=n},[n]);const v=s=>Number(s||0).toLocaleString(),L=s=>{const a=String(s||"").toLowerCase();return a.includes("ref")?{icon:I,color:"sky"}:a.includes("quiz")||a.includes("prize")||a.includes("reward")?{icon:P,color:"emerald"}:a.includes("credit")||a.includes("daily")?{icon:z,color:"amber"}:a.includes("refund")?{icon:Q,color:"indigo"}:a.includes("purchase")?{icon:V,color:"fuchsia"}:a.includes("debit")||a.includes("join")?{icon:O,color:"rose"}:{icon:y,color:"slate"}},_={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.06}}},l={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return e.jsxs("div",{className:"relative pt-14 pb-4",children:[e.jsx(M,{title:"Wallet â€“ Quiz Dangal",description:"View your Quiz Dangal wallet balance, recent transactions, and referral earnings.",canonical:"https://quizdangal.com/wallet/",robots:"noindex, nofollow"}),e.jsxs(r.div,{className:"px-4 py-4 mx-auto w-full max-w-md sm:max-w-lg",variants:_,initial:"hidden",animate:"visible",children:[e.jsxs(r.div,{variants:l,className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center",children:e.jsx(y,{className:"w-5 h-5 text-white"})}),e.jsx("h1",{className:"text-xl font-bold text-white",children:"My Wallet"})]}),e.jsxs(r.div,{variants:l,className:"relative mb-5 rounded-2xl overflow-hidden border border-amber-500/20",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-900/40 via-slate-900 to-orange-900/30"}),e.jsxs("div",{className:"relative p-5 flex items-center gap-4",children:[e.jsx(r.div,{animate:C?{scale:[1,1.2,1]}:{},className:"w-14 h-14 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center shadow-lg shadow-amber-500/30",children:e.jsx(z,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-0.5",children:"Your Balance"}),e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsx("span",{className:"text-3xl font-black text-white",children:v(n)}),e.jsx("span",{className:"text-sm font-semibold text-amber-400",children:"coins"})]})]})]})]}),e.jsxs(r.div,{variants:l,className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsxs(h,{to:"/refer",className:"flex items-center justify-center gap-2 py-3 px-4 rounded-xl bg-gradient-to-r from-emerald-500 to-cyan-500 shadow-lg shadow-emerald-500/25 hover:shadow-emerald-500/40 hover:scale-[1.02] active:scale-[0.98] transition-all",children:[e.jsx(W,{className:"w-4 h-4 text-white"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Refer & Earn"})]}),e.jsxs(h,{to:"/redemptions",className:"flex items-center justify-center gap-2 py-3 px-4 rounded-xl bg-gradient-to-r from-violet-500 to-fuchsia-500 shadow-lg shadow-violet-500/25 hover:shadow-violet-500/40 hover:scale-[1.02] active:scale-[0.98] transition-all",children:[e.jsx($,{className:"w-4 h-4 text-white"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Redeem"})]})]}),e.jsx(r.div,{variants:l,className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl bg-cyan-500/10 border border-cyan-500/30",children:[e.jsx(B,{className:"w-5 h-5 text-cyan-400"}),e.jsx(h,{to:"/",className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium text-cyan-200",children:"Play Quizzes to Earn More!"})})]})}),e.jsxs(r.div,{variants:l,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Recent Activity"]})}),S?e.jsx("div",{className:"space-y-2",children:[1,2,3].map(s=>e.jsx("div",{className:"p-3 rounded-xl bg-slate-800/40 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-slate-700"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 w-20 bg-slate-700 rounded mb-2"}),e.jsx("div",{className:"h-2 w-14 bg-slate-700 rounded"})]}),e.jsx("div",{className:"h-4 w-16 bg-slate-700 rounded"})]})},s))}):f.length===0?e.jsxs("div",{className:"text-center py-10 bg-slate-800/30 rounded-2xl border border-dashed border-slate-700/50",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸª™"}),e.jsx("p",{className:"text-slate-400 font-medium mb-1",children:"No transactions yet"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Play quizzes and start earning!"})]}):e.jsx("div",{className:"space-y-2",children:f.map((s,a)=>{const w=(s.type||"").toLowerCase(),m=R.includes(w),x=L(w),E=x.icon;return e.jsxs(r.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.04},className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-xl border border-slate-700/30 hover:border-slate-600/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 rounded-full bg-${x.color}-500/20 flex items-center justify-center`,children:e.jsx(E,{className:`w-4 h-4 text-${x.color}-400`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-200 capitalize",children:s.type||"Transaction"}),e.jsx("p",{className:"text-xs text-slate-500",children:new Date(s.created_at).toLocaleDateString("en-IN",{day:"numeric",month:"short"})})]})]}),e.jsxs("div",{className:`flex items-center gap-1 ${m?"text-emerald-400":"text-rose-400"}`,children:[m?e.jsx(A,{className:"w-4 h-4"}):e.jsx(G,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-bold text-sm",children:[m?"+":"-",v(Math.abs(Number(s.amount)||0))]})]})]},s.id)})})]})]})]})};export{X as default};
