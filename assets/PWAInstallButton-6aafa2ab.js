import{j as r}from"./index-b2bada1c.js";import{r as c}from"./react-63c462fe.js";import{a9 as v}from"./icons-2bdec3f2.js";import"./supabase-24c2e735.js";import"./router-d6d570a4.js";const E=()=>{const[m,f]=c.useState(!1),[l,o]=c.useState(null);c.useEffect(()=>{if(typeof window=="undefined")return;const e=typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)"):null;f((()=>{var t;try{return!!(e!=null&&e.matches||((t=window.navigator)==null?void 0:t.standalone)===!0)}catch(w){return!1}})());const i=t=>{var w;f(!!(t!=null&&t.matches)||((w=window.navigator)==null?void 0:w.standalone)===!0)};if(e)try{e.addEventListener("change",i)}catch(t){e.addListener&&e.addListener(i)}const d=t=>{t.preventDefault(),o(t)},s=()=>{o(null)};try{!l&&window.__qdDeferredPrompt&&o(window.__qdDeferredPrompt)}catch(t){}const p=()=>{try{window.__qdDeferredPrompt&&o(window.__qdDeferredPrompt)}catch(t){}},n=()=>{o(null)};return window.addEventListener("beforeinstallprompt",d),window.addEventListener("appinstalled",s),window.addEventListener("qd:beforeinstallprompt",p),window.addEventListener("qd:appinstalled",n),()=>{if(window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",s),window.removeEventListener("qd:beforeinstallprompt",p),window.removeEventListener("qd:appinstalled",n),e)try{e.removeEventListener("change",i)}catch(t){e.removeListener&&e.removeListener(i)}}},[l]);const u=(e=2500)=>new Promise(a=>{if(typeof window=="undefined")return a(null);try{if(window.__qdDeferredPrompt)return a(window.__qdDeferredPrompt)}catch(n){}let i=!1;const d=n=>{i||(i=!0,window.removeEventListener("beforeinstallprompt",s),window.removeEventListener("qd:beforeinstallprompt",p),a(n))},s=n=>{try{n.preventDefault()}catch(t){}o(n);try{window.__qdDeferredPrompt=n}catch(t){}d(n)},p=()=>{try{if(window.__qdDeferredPrompt){o(window.__qdDeferredPrompt),d(window.__qdDeferredPrompt);return}}catch(n){}};try{window.addEventListener("beforeinstallprompt",s,{once:!0})}catch(n){window.addEventListener("beforeinstallprompt",s)}window.addEventListener("qd:beforeinstallprompt",p),window.setTimeout(()=>d(null),Math.max(0,e))}),h=async()=>{try{if(l){l.prompt(),await l.userChoice,o(null);return}try{typeof window!="undefined"&&"serviceWorker"in navigator&&window.isSecureContext&&await navigator.serviceWorker.register("/sw.js",{scope:"/",updateViaCache:"none"})}catch(a){}const e=await u(2500);if(e){e.prompt(),await e.userChoice,o(null);try{window.__qdDeferredPrompt=null}catch(a){}}}catch(e){}};return m?null:r.jsxs("button",{onClick:h,className:"w-14 h-14 rounded-full btn-fire transition-all duration-300 transform hover:scale-105 flex items-center justify-center group relative overflow-hidden shadow-lg",style:{position:"fixed",bottom:"100px",right:"20px",zIndex:9999},"aria-label":"Install App",title:"Install App",children:[r.jsxs("svg",{className:"pointer-events-none absolute -top-2 left-1/2 -translate-x-1/2 w-6 h-6 opacity-70",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:[r.jsx("path",{d:"M12 2c1.5 2 2 3.5 2 5 0 1.5-.5 3-2 4-1.5-1-2-2.5-2-4 0-1.5.5-3 2-5Z",fill:"url(#flameGrad)"}),r.jsx("defs",{children:r.jsxs("linearGradient",{id:"flameGrad",x1:"12",y1:"2",x2:"12",y2:"11",gradientUnits:"userSpaceOnUse",children:[r.jsx("stop",{stopColor:"#fde047"}),r.jsx("stop",{offset:"1",stopColor:"#f97316"})]})})]}),r.jsx("div",{className:"absolute inset-0"}),r.jsx(v,{className:"w-5 h-5 relative z-10 drop-shadow text-white"}),r.jsx("span",{className:"hidden group-hover:block absolute right-16 bg-gray-900/90 backdrop-blur text-white px-2 py-1 rounded text-xs whitespace-nowrap border border-white/10 shadow",children:"Install App"})]})};export{E as default};
